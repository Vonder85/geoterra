---
import Analytics from "@vercel/analytics/astro";

export interface Props {
  title: string;
  description?: string;
  keywords?: string;
  author?: string;
  ogType?: string;
  jsonLd?: object;
}

const {
  title,
  description = "GEOTERRA - Bureau d'étude géotechnique, situé en Vendée, expert en analyse de sols et fondations",
  keywords = "géotechnique, geotechnique, geo-technique, geo technique, étude de sol, etude de sol, etude du sol, étude des sols, etude des sols, analyse de sol, analyse du sol, analyse des sols, fondations, fondation, bureau d'étude, bureau etude, Vendée, Vendee, Loire Atlantique, Loire-Atlantique, rénovation, renovation, BTP, argile, étude, etude, sondage, sondages, reconnaissance de sol, G1, G2, G5, geotechnicien, géotechnicien, ingénieur géotechnique, ingenieur geotechnique",
  author = "GEOTERRA",
  ogType = "website",
  jsonLd,
} = Astro.props;

const SITE_URL = "https://be-geoterra.fr";
const logoUrl = `${SITE_URL}/favicon.png`;
const canonicalURL = new URL(Astro.url.pathname, SITE_URL).href;

// Schema.org JSON-LD par défaut pour LocalBusiness
const defaultJsonLd = {
  "@context": "https://schema.org",
  "@type": ["LocalBusiness", "ProfessionalService"],
  name: "GEOTERRA",
  description:
    "Bureau d'études géotechniques spécialisé dans la maison individuelle et petits collectifs en Vendée et Loire-Atlantique",
  url: SITE_URL,
  logo: logoUrl,
  image: logoUrl,
  telephone: "+33 2 51 25 78 90",
  email: "contact@geoterra.fr",
  address: {
    "@type": "PostalAddress",
    streetAddress: "Zone d'activité",
    addressLocality: "Vendée",
    addressRegion: "Pays de la Loire",
    postalCode: "85000",
    addressCountry: "FR",
  },
  geo: {
    "@type": "GeoCoordinates",
    latitude: 46.6703,
    longitude: -1.4269,
  },
  areaServed: [
    {
      "@type": "State",
      name: "Vendée",
    },
    {
      "@type": "State",
      name: "Loire-Atlantique",
    },
  ],
  priceRange: "€€",
  openingHoursSpecification: {
    "@type": "OpeningHoursSpecification",
    dayOfWeek: ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
    opens: "08:00",
    closes: "18:00",
  },
  founder: [
    {
      "@type": "Person",
      name: "Vincent Menuet",
      jobTitle: "Gérant",
    },
    {
      "@type": "Person",
      name: "Maxime Robin",
      jobTitle: "Gérant",
    },
  ],
  sameAs: [SITE_URL],
  knowsAbout: [
    "Géotechnique",
    "Geo-technique",
    "Étude de sol",
    "Étude des sols",
    "Analyse de sol",
    "Analyse des sols",
    "Reconnaissance de sol",
    "Sondage géotechnique",
    "Fondations",
    "Étude G1",
    "Étude G2",
    "Étude G5",
    "Mission géotechnique",
    "Investigation géotechnique",
    "Dimensionnement de fondations",
    "Construction maison individuelle",
    "Essais de sol",
    "Bureau d'étude géotechnique",
  ],
};

const finalJsonLd = jsonLd || defaultJsonLd;
const jsonLdArray = Array.isArray(finalJsonLd) ? finalJsonLd : [finalJsonLd];
---

<!doctype html>
<html lang='fr'>
  <head>
    <meta charset='UTF-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />

    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name='title' content={title} />
    <meta name='description' content={description} />
    <meta name='keywords' content={keywords} />
    <meta name='author' content={author} />
    <meta name='robots' content='index, follow' />
    <meta name='language' content='French' />
    <meta name='revisit-after' content='7 days' />
    <meta name='copyright' content='GEOTERRA' />

    <!-- Canonical URL -->
    <link rel='canonical' href={canonicalURL} />

    <!-- Favicon and Icons -->
    <link rel='icon' type='image/x-icon' href='/favicon.ico' />
    <link rel='icon' type='image/png' sizes='32x32' href='/favicon.png' />
    <link rel='icon' type='image/png' sizes='192x192' href='/icon-192.png' />
    <link rel='icon' type='image/png' sizes='512x512' href='/icon-512.png' />
    <link rel='apple-touch-icon' sizes='180x180' href='/apple-touch-icon.png' />
    <link rel='manifest' href='/site.webmanifest' />

    <!-- Preload critical resources -->
    <link rel='preload' href={logoUrl} as='image' type='image/png' />

    <!-- DNS Prefetch for external resources -->
    <link rel='dns-prefetch' href='https://fonts.googleapis.com' />

    <!-- Google Site Verification -->
    <meta
      name='google-site-verification'
      content='iUFJyQvRQy-xC97ZLoOhV88z0RQJd2EZv2bBr3wiAwg'
    />

    <!-- Open Graph / Facebook -->
    <meta property='og:type' content={ogType} />
    <meta property='og:url' content={canonicalURL} />
    <meta property='og:site_name' content='GEOTERRA' />
    <meta property='og:title' content={title} />
    <meta property='og:description' content={description} />
    <meta property='og:image' content={logoUrl} />
    <meta property='og:image:width' content='1200' />
    <meta property='og:image:height' content='630' />
    <meta
      property='og:image:alt'
      content="GEOTERRA - Bureau d'études géotechniques"
    />
    <meta property='og:locale' content='fr_FR' />

    <!-- Twitter -->
    <meta name='twitter:card' content='summary_large_image' />
    <meta name='twitter:url' content={canonicalURL} />
    <meta name='twitter:title' content={title} />
    <meta name='twitter:description' content={description} />
    <meta name='twitter:image' content={logoUrl} />
    <meta
      name='twitter:image:alt'
      content="GEOTERRA - Bureau d'études géotechniques"
    />

    <!-- Geo Tags for Local SEO -->
    <meta name='geo.region' content='FR-85' />
    <meta name='geo.region' content='FR-44' />
    <meta name='geo.placename' content='Vendée' />
    <meta name='geo.placename' content='Loire-Atlantique' />
    <meta name='geo.position' content='46.6703;-1.4269' />
    <meta name='ICBM' content='46.6703, -1.4269' />

    <!-- JSON-LD Structured Data -->
    {
      jsonLdArray.map((schema) => (
        <script
          type='application/ld+json'
          set:html={JSON.stringify(schema)}
          is:inline
        />
      ))
    }

    <meta name='generator' content={Astro.generator} />
    <Analytics />
  </head>
  <body class='min-h-screen bg-white'>
    <slot />
  </body>
</html>
